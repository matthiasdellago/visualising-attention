# visualising-attention
Visualising (self)-attention as a vector field: exploring and building intuition.

[Click here to see what attention looks like!](https://anvaka.github.io/fieldplay/?dt=0.0009&fo=0.996&dp=0.00109999999999999&cm=3&cx=0.09494999999999987&cy=1.3819999999999997&w=26.997500000000002&h=26.997500000000002&vf=%2F%2F%20Visualising%20the%20field%20that%203%20attention%20vectors%20create%20in%202d%0A%2F%2F%20Play%20with%20the%20parameters%20and%20see%20what%20happens!%0A%2F%2F%20Check%20out%20more%20visualisations%20at%20github.com%2Fmatthiasdellago%2Fvisualising-attention%0A%0Avec2%20attention%28vec2%20p%29%20%7B%0A%20%20%0A%20%20%2F%2F%20init%20v%0A%20%20vec2%20v%20%3D%20vec2%280.%2C%200.%29%3B%0A%20%20%0A%20%20%2F%2F%20scale%20defined%20separately%20to%20easily%20change%20it.%20Try%20it!%0A%20%20float%20scale%20%3D%203.%3B%0A%20%20%0A%20%20%2F%2Fdefine%20attention%20vectors%0A%20%20vec2%20f1%20%3D%20scale%20*%20vec2%280.%2C1.5%29%3B%0A%20%20vec2%20f2%20%3D%20scale%20*%20vec2%281.%2C0.%29%3B%0A%20%20vec2%20f3%20%3D%20scale%20*%20vec2%28-1.5%2C0%29%3B%0A%0A%20%20%2F%2F%20calc%20projections%20-%3E%20weights%0A%20%20float%20w1%20%3D%20dot%28p%2Cf1%29%3B%0A%20%20float%20w2%20%3D%20dot%28p%2Cf2%29%3B%0A%20%20float%20w3%20%3D%20dot%28p%2Cf3%29%3B%0A%0A%20%20%2F%2F%20softmax%0A%20%20float%20sum%20%3D%20exp%28w1%29%2Bexp%28w2%29%2Bexp%28w3%29%3B%0A%20%20w1%20%3D%20exp%28w1%29%2Fsum%3B%0A%20%20w2%20%3D%20exp%28w2%29%2Fsum%3B%0A%20%20w3%20%3D%20exp%28w3%29%2Fsum%3B%0A%0A%20%20%2F%2F%20linear%20combination%0A%20%20vec2%20new_p%20%3D%20w1*f1%20%2B%20w2*f2%20%2B%20w3*f3%3B%0A%20%20%0A%20%20%2F%2F%20calc%20delta%20of%20p%0A%20%20v%20%3D%20new_p%20-%20p%3B%0A%0A%20%20return%20v%3B%0A%7D%0A%0Avec2%20get_velocity%28vec2%20p%29%7B%0A%20%20%2F%2F%20get%20p.x%20and%20p.y%2C%20the%20current%20coordinates%0A%20%20%2F%2F%20return%20v.x%20and%20v.y%2C%20the%20velocity%20at%20point%20p%0A%20%20return%20attention%28p%29%3B%0A%7D&code=%2F%2F%20Visualising%20the%20field%20that%203%20attention%20vectors%20create%20in%202d%0A%2F%2F%20Play%20with%20the%20parameters%20and%20see%20what%20happens!%0A%2F%2F%20Check%20out%20more%20visualisations%20at%20github.com%2Fmatthiasdellago%2Fvisualising-attention%0A%0Avec2%20attention%28vec2%20p%29%20%7B%0A%20%20%0A%20%20%2F%2F%20init%20v%0A%20%20vec2%20v%20%3D%20vec2%280.%2C%200.%29%3B%0A%20%20%0A%20%20%2F%2F%20scale%20defined%20separately%20to%20easily%20change%20it.%20Try%20it!%0A%20%20float%20scale%20%3D%203.%3B%0A%20%20%0A%20%20%2F%2Fdefine%20attention%20vectors%0A%20%20vec2%20f1%20%3D%20scale%20*%20vec2%280.%2C1.5%29%3B%0A%20%20vec2%20f2%20%3D%20scale%20*%20vec2%281.%2C0.%29%3B%0A%20%20vec2%20f3%20%3D%20scale%20*%20vec2%28-1.5%2C0%29%3B%0A%0A%20%20%2F%2F%20calc%20projections%20-%3E%20weights%0A%20%20float%20w1%20%3D%20dot%28p%2Cf1%29%3B%0A%20%20float%20w2%20%3D%20dot%28p%2Cf2%29%3B%0A%20%20float%20w3%20%3D%20dot%28p%2Cf3%29%3B%0A%0A%20%20%2F%2F%20softmax%0A%20%20float%20sum%20%3D%20exp%28w1%29%2Bexp%28w2%29%2Bexp%28w3%29%3B%0A%20%20w1%20%3D%20exp%28w1%29%2Fsum%3B%0A%20%20w2%20%3D%20exp%28w2%29%2Fsum%3B%0A%20%20w3%20%3D%20exp%28w3%29%2Fsum%3B%0A%0A%20%20%2F%2F%20linear%20combination%0A%20%20vec2%20new_p%20%3D%20w1*f1%20%2B%20w2*f2%20%2B%20w3*f3%3B%0A%20%20%0A%20%20%2F%2F%20calc%20delta%20of%20p%0A%20%20v%20%3D%20new_p%20-%20p%3B%0A%0A%20%20return%20v%3B%0A%7D%0A%0Avec2%20get_velocity%28vec2%20p%29%7B%0A%20%20%2F%2F%20get%20p.x%20and%20p.y%2C%20the%20current%20coordinates%0A%20%20%2F%2F%20return%20v.x%20and%20v.y%2C%20the%20velocity%20at%20point%20p%0A%20%20return%20attention%28p%29%3B%0A%7D&pc=90000)

Just copy paste one of the glsl files into [fieldplax](https://anvaka.github.io/fieldplay) or direcly include one of my scrips by pasiting a line like this into the code field:

```
#include https://raw.githubusercontent.com/matthiasdellago/visualising-attention/main/attention.glsl
```
